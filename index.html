
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    

    <title>Documentation &mdash; root_numpy 3.1.1.dev documentation</title>

<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/>


    
    <link rel="stylesheet" href="_static/rtd.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '3.1.1.dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/searchtools.js"></script>
    <link rel="top" title="root_numpy 3.1.1.dev documentation" href="#" />
    <link rel="next" title="1. Installation" href="install.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="install.html" title="1. Installation"
             accesskey="N">next</a> |</li>
        <li><a href="#">root_numpy 3.1.1.dev documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1 class="main">root_numpy</h1>
<h2 class="main">An interface between ROOT and NumPy</h2><p>root_numpy is a Python extension module that provides an efficient interface
between <a class="reference external" href="http://root.cern.ch/">ROOT</a> and <a class="reference external" href="http://www.numpy.org/">NumPy</a>.
root_numpy&#8217;s internals are compiled C++ and can therefore handle
large amounts of data much faster than equivalent pure Python implementations.</p>
<p>With your ROOT data in NumPy form, make use of NumPy&#8217;s
<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/">broad library</a>, including
fancy indexing, slicing, broadcasting, random sampling, sorting,
shape transformations, linear algebra operations, and more.
See this introductory
<a class="reference external" href="http://wiki.scipy.org/Tentative_NumPy_Tutorial">tutorial</a> to get started.
NumPy is the fundamental library of the scientific Python ecosystem.
Using NumPy arrays opens up many new possibilities beyond what ROOT
offers. Convert your TTrees into NumPy arrays and use
<a class="reference external" href="http://www.scipy.org/">SciPy</a> for numerical integration and optimization,
<a class="reference external" href="http://matplotlib.org/">matplotlib</a> for plotting,
<a class="reference external" href="http://pandas.pydata.org/">pandas</a> for data analysis,
<a class="reference external" href="http://statsmodels.sourceforge.net/">statsmodels</a> for statistical modelling,
<a class="reference external" href="http://scikit-learn.org/">scikit-learn</a> for machine learning,
and perform quick exploratory analysis in interactive environments like
<a class="reference external" href="http://ipython.org/">IPython</a>, especially IPython&#8217;s popular
<a class="reference external" href="http://ipython.org/ipython-doc/dev/interactive/notebook.html">notebook</a>
feature.</p>
<p>At the core of root_numpy are powerful and flexible functions for converting
<a class="reference external" href="http://root.cern.ch/root/html/TTree.html">ROOT TTrees</a> into NumPy
<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html">recarrays</a>
or <a class="reference external" href="http://docs.scipy.org/doc/numpy/user/basics.rec.html">structured arrays</a>
as well as converting NumPy arrays back into ROOT TTrees.
root_numpy can convert branches of basic types such as bool, int, float,
double, etc. as well as variable and fixed-length 1D arrays and vectors
of basic types.</p>
<p>For example, get a NumPy structured or record array from a TTree
(copy and paste the following examples into your Python prompt):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">ROOT</span>
<span class="kn">from</span> <span class="nn">root_numpy</span> <span class="kn">import</span> <span class="n">root2array</span><span class="p">,</span> <span class="n">root2rec</span><span class="p">,</span> <span class="n">tree2rec</span>
<span class="kn">from</span> <span class="nn">root_numpy.testdata</span> <span class="kn">import</span> <span class="n">get_filepath</span>

<span class="n">filename</span> <span class="o">=</span> <span class="n">get_filepath</span><span class="p">(</span><span class="s">&#39;test.root&#39;</span><span class="p">)</span>

<span class="c"># Convert a TTree in a ROOT file into a NumPy structured array</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">root2array</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;tree&#39;</span><span class="p">)</span>
<span class="c"># The TTree name is always optional if there is only one TTree in the file</span>

<span class="c"># Convert a TTree in a ROOT file into a NumPy record array</span>
<span class="n">rec</span> <span class="o">=</span> <span class="n">root2rec</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;tree&#39;</span><span class="p">)</span>

<span class="c"># Get the TTree from the ROOT file</span>
<span class="n">rfile</span> <span class="o">=</span> <span class="n">ROOT</span><span class="o">.</span><span class="n">TFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">intree</span> <span class="o">=</span> <span class="n">rfile</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="s">&#39;tree&#39;</span><span class="p">)</span>

<span class="c"># Convert the TTree into a NumPy record array</span>
<span class="n">rec</span> <span class="o">=</span> <span class="n">tree2rec</span><span class="p">(</span><span class="n">intree</span><span class="p">)</span>
</pre></div>
</div>
<p>Include specific branches or expressions and only entries passing a selection:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">rec</span> <span class="o">=</span> <span class="n">tree2rec</span><span class="p">(</span><span class="n">intree</span><span class="p">,</span>
    <span class="n">branches</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;sqrt(y)&#39;</span><span class="p">,</span> <span class="s">&#39;TMath::Landau(x)&#39;</span><span class="p">,</span> <span class="s">&#39;cos(x)*sin(y)&#39;</span><span class="p">],</span>
    <span class="n">selection</span><span class="o">=</span><span class="s">&#39;z &gt; 0&#39;</span><span class="p">,</span>
    <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>The above conversion creates an array with five columns from the branches
x and y where z is greater than zero and only looping on the first ten entries
in the tree while skipping every second entry.</p>
<p>Now convert our array back into a TTree:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">root_numpy</span> <span class="kn">import</span> <span class="n">array2tree</span><span class="p">,</span> <span class="n">array2root</span>

<span class="c"># Rename the fields</span>
<span class="n">rec</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;sqrt_y&#39;</span><span class="p">,</span> <span class="s">&#39;landau_x&#39;</span><span class="p">,</span> <span class="s">&#39;cos_x_sin_y&#39;</span><span class="p">)</span>

<span class="c"># Convert the NumPy record array into a TTree</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">array2tree</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;tree&#39;</span><span class="p">)</span>

<span class="c"># Dump directly into a ROOT file without using PyROOT</span>
<span class="n">array2root</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span> <span class="s">&#39;selected_tree.root&#39;</span><span class="p">,</span> <span class="s">&#39;tree&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>root_numpy also provides a function for filling a ROOT histogram from a NumPy
array:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ROOT</span> <span class="kn">import</span> <span class="n">TH2D</span><span class="p">,</span> <span class="n">TCanvas</span>
<span class="kn">from</span> <span class="nn">root_numpy</span> <span class="kn">import</span> <span class="n">fill_hist</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c"># Fill a ROOT histogram from a NumPy array</span>
<span class="n">hist</span> <span class="o">=</span> <span class="n">TH2D</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;title&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">fill_hist</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mf">1E6</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">canvas</span> <span class="o">=</span> <span class="n">TCanvas</span><span class="p">();</span> <span class="n">hist</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="s">&#39;LEGO2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>and a function for creating a random NumPy array by sampling a ROOT function
or histogram:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ROOT</span> <span class="kn">import</span> <span class="n">TF2</span><span class="p">,</span> <span class="n">TH1D</span>
<span class="kn">from</span> <span class="nn">root_numpy</span> <span class="kn">import</span> <span class="n">random_sample</span>

<span class="c"># Sample a ROOT function</span>
<span class="n">func</span> <span class="o">=</span> <span class="n">TF2</span><span class="p">(</span><span class="s">&#39;func&#39;</span><span class="p">,</span> <span class="s">&#39;sin(x)*sin(y)/(x*y)&#39;</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">random_sample</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mf">1E6</span><span class="p">)</span>

<span class="c"># Sample a ROOT histogram</span>
<span class="n">hist</span> <span class="o">=</span> <span class="n">TH1D</span><span class="p">(</span><span class="s">&#39;hist&#39;</span><span class="p">,</span> <span class="s">&#39;hist&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">hist</span><span class="o">.</span><span class="n">FillRandom</span><span class="p">(</span><span class="s">&#39;gaus&#39;</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">random_sample</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="mf">1E6</span><span class="p">)</span>
</pre></div>
</div>
<p>Also see the <a class="reference external" href="http://www.rootpy.org/commands/root2hdf5.html">root2hdf5</a>
script in the <a class="reference external" href="https://github.com/rootpy/rootpy">rootpy</a>
package that uses root_numpy and <a class="reference external" href="http://www.pytables.org">PyTables</a> to
convert all TTrees in a ROOT file into the
<a class="reference external" href="http://www.hdfgroup.org/HDF5/">HDF5</a> format.</p>
<div class="section" id="documentation">
<h1>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">1. Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#requirements">1.1. Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#getting-the-latest-source">1.2. Getting the Latest Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#manual-installation">1.3. Manual Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#automatic-installation">1.4. Automatic Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#running-the-tests">1.5. Running the Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="start.html">2. Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="start.html#try-root-numpy-on-cern-s-lxplus">2.1. Try <cite>root_numpy</cite> on CERN&#8217;s LXPLUS</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#have-questions-or-found-a-bug">2.2. Have Questions or Found a Bug?</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#contributing">2.3. Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference/index.html">3. root_numpy Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.array.html">3.1. root_numpy.array</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.matrix.html">3.2. root_numpy.matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.root2array.html">3.3. root_numpy.root2array</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.root2rec.html">3.4. root_numpy.root2rec</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.tree2array.html">3.5. root_numpy.tree2array</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.tree2rec.html">3.6. root_numpy.tree2rec</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.array2tree.html">3.7. root_numpy.array2tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.array2root.html">3.8. root_numpy.array2root</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.fill_hist.html">3.9. root_numpy.fill_hist</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.random_sample.html">3.10. root_numpy.random_sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.list_trees.html">3.11. root_numpy.list_trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.list_branches.html">3.12. root_numpy.list_branches</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.list_structures.html">3.13. root_numpy.list_structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.stretch.html">3.14. root_numpy.stretch</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/generated/root_numpy.blockwise_inner_join.html">3.15. root_numpy.blockwise_inner_join</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/index.html#type-conversion-table">3.16. Type Conversion Table</a></li>
</ul>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Next topic</h4>
  <p class="topless"><a href="install.html"
                        title="next chapter">1. Installation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="install.html" title="1. Installation"
             >next</a> |</li>
        <li><a href="#">root_numpy 3.1.1.dev documentation</a> &raquo;</li> 
      </ul>
    </div>
<div class="footer">
    &copy; Copyright 2013, rootpy developers and contributors.
</div>



<!-- Google Analytics Code -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-39364267-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>